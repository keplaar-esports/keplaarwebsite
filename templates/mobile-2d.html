<!-- ============================================ -->
<!-- MOBILE TEMPLATE - 2D Scrollable Experience -->
<!-- ============================================ -->

<!-- This will be loaded into #app-container for mobile users -->

<!-- Mobile Header -->
<header id="mobile-header">
  <div class="mobile-header-content">
    <img src="assets/textures/logo.png" alt="Keplaar Esports" class="mobile-logo">
    <h1 class="mobile-title">KEPLAAR ESPORTS</h1>
    <button id="mobile-menu-toggle" class="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>
  
  <!-- Mobile Navigation Menu -->
  <nav id="mobile-nav" class="mobile-nav-menu">
    <a href="#hero" data-section="hero">Home</a>
    <a href="#events" data-section="events">Events</a>
    <a href="#about" data-section="about">About Us</a>
    <a href="#team" data-section="team">Our Team</a>
    <a href="#giveaways" data-section="giveaways">Giveaways</a>
    <a href="#join" data-section="join">Join Us</a>
  </nav>
</header>

<!-- Mobile Content Container -->
<div id="mobile-content">
  
  <!-- Hero Section -->
  <section id="hero" class="mobile-section hero-section">
    <div class="section-content">
      <img src="assets/textures/logo.png" alt="Keplaar Esports" class="hero-logo">
      <h1>KEPLAAR ESPORTS</h1>
      <p class="hero-subtitle">Canada's Premier Esports Organization</p>
      <p class="hero-tagline">Version 2.0 | 2025</p>
      <button class="cta-button" onclick="document.getElementById('events').scrollIntoView({behavior: 'smooth'})">
        Explore Events
      </button>
    </div>
  </section>

  <!-- Upcoming Events Section -->
  <section id="events" class="mobile-section">
    <div class="section-content">
      <h2 class="section-title">Upcoming Events</h2>
      
      <div class="event-card">
        <div class="event-icon">üéÆ</div>
        <h3>Event 1</h3>
        <p>Coming Soon</p>
        <button class="event-button">Learn More</button>
      </div>
      
      <div class="event-card">
        <div class="event-icon">üèÜ</div>
        <h3>Event 2</h3>
        <p>Coming Soon</p>
        <button class="event-button">Learn More</button>
      </div>
      
      <div class="event-card">
        <div class="event-icon">‚ö°</div>
        <h3>Event 3</h3>
        <p>Coming Soon</p>
        <button class="event-button">Learn More</button>
      </div>
    </div>
  </section>

  <!-- About Us Section -->
  <section id="about" class="mobile-section">
    <div class="section-content">
      <h2 class="section-title">About Us</h2>
      <p class="section-description">
        Founded in 2024, Keplaar Esports is Canada's premier esports organization. 
        We're dedicated to competitive excellence and building a thriving gaming community.
      </p>
      <div class="about-stats">
        <div class="stat">
          <h3>2024</h3>
          <p>Founded</p>
        </div>
        <div class="stat">
          <h3>5+</h3>
          <p>Games</p>
        </div>
        <div class="stat">
          <h3>Pro</h3>
          <p>Team</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Team Section -->
  <section id="team" class="mobile-section">
    <div class="section-content">
      <h2 class="section-title">Our Team</h2>
      
      <!-- Swipeable team cards -->
      <div class="team-cards">
        <div class="team-card">
          <div class="team-photo">üë§</div>
          <h3>Amogh Ingale</h3>
          <p class="team-role">CEO</p>
          <button class="linkedin-button">LinkedIn</button>
        </div>
        
        <div class="team-card">
          <div class="team-photo">üë§</div>
          <h3>Min Zhao</h3>
          <p class="team-role">CFO</p>
          <button class="linkedin-button">LinkedIn</button>
        </div>
        
        <div class="team-card">
          <div class="team-photo">üë§</div>
          <h3>Jason Lee</h3>
          <p class="team-role">CTO</p>
          <button class="linkedin-button">LinkedIn</button>
        </div>
        
        <div class="team-card">
          <div class="team-photo">üë§</div>
          <h3>Andy Chen</h3>
          <p class="team-role">CPO</p>
          <button class="linkedin-button">LinkedIn</button>
        </div>
        
        <div class="team-card">
          <div class="team-photo">üë§</div>
          <h3>Ahmed Abdi</h3>
          <p class="team-role">COO</p>
          <button class="linkedin-button">LinkedIn</button>
        </div>
      </div>
      
      <p class="swipe-hint">‚Üê Swipe to see more ‚Üí</p>
    </div>
  </section>

  <!-- Giveaways Section -->
  <section id="giveaways" class="mobile-section">
    <div class="section-content">
      <h2 class="section-title">Giveaways</h2>
      <p class="section-description">
        Stay tuned for exciting giveaways and exclusive merchandise!
      </p>
      <div class="giveaway-placeholder">
        <div class="placeholder-icon">üéÅ</div>
        <p>New giveaways coming soon</p>
      </div>
    </div>
  </section>

  <!-- Join Us Section -->
  <section id="join" class="mobile-section">
    <div class="section-content">
      <h2 class="section-title">Join Us</h2>
      
      <!-- Social Media Links -->
      <div class="social-links-mobile">
        <a href="#" class="social-link" data-platform="instagram">
          <img src="assets/icons/instagram.png" alt="Instagram">
          <span>Instagram</span>
        </a>
        <a href="#" class="social-link" data-platform="twitter">
          <img src="assets/icons/x.png" alt="Twitter">
          <span>Twitter/X</span>
        </a>
        <a href="#" class="social-link" data-platform="youtube">
          <img src="assets/icons/youtube.png" alt="YouTube">
          <span>YouTube</span>
        </a>
        <a href="#" class="social-link" data-platform="discord">
          <img src="assets/icons/discord.png" alt="Discord">
          <span>Discord</span>
        </a>
      </div>
      
      <!-- Application Form Button -->
      <button class="cta-button" id="show-mobile-form">
        Apply to Join Team
      </button>
    </div>
  </section>

</div>

<!-- Mobile Application Form Modal -->
<div id="mobile-form-modal" class="mobile-modal" style="display: none;">
  <div class="modal-content">
    <button class="modal-close">&times;</button>
    <h2>Join Keplaar Esports</h2>
    
    <form id="mobile-application-form">
      <input type="text" name="name" placeholder="Full Name *" required>
      <input type="email" name="email" placeholder="Email *" required>
      <input type="tel" name="phone" placeholder="Phone *" required>
      
      <select name="game" required>
        <option value="">Select Game *</option>
        <option value="valorant">VALORANT</option>
        <option value="fortnite">Fortnite</option>
        <option value="dota2">Dota 2</option>
        <option value="pubg">PUBG</option>
      </select>
      
      <input type="text" name="rank" placeholder="Current Rank *" required>
      <input type="text" name="game_id" placeholder="In-Game ID *" required>
      
      <!-- File Upload Section -->
      <div class="mobile-file-upload" style="pointer-events: auto;">
        <label class="file-upload-label">Portfolio/Highlights (Optional)</label>
        <div class="file-upload-container" style="pointer-events: auto;">
          <div class="file-drop-zone" id="mobile2d-file-drop" style="position: relative; pointer-events: auto;">
            <div class="drop-zone-content" style="pointer-events: none;">
              <span class="file-icon">üìÑ</span>
              <span class="file-text">Tap to upload PDF</span>
              <span class="file-hint">Max 5MB</span>
            </div>
            <input type="file" 
                   id="mobile2d-portfolio" 
                   name="portfolio" 
                   accept=".pdf,.PDF" 
                   style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer; z-index: 10; pointer-events: auto;">
          </div>
          
          <div class="file-preview" id="mobile2d-file-preview" style="display: none;">
            <span class="preview-icon">üìÑ</span>
            <div class="preview-info">
              <span class="preview-name" id="mobile2d-file-name"></span>
              <span class="preview-size" id="mobile2d-file-size"></span>
            </div>
            <button type="button" class="preview-remove" id="mobile2d-file-remove">‚úï</button>
          </div>
        </div>
      </div>
      
      <button type="submit" class="submit-button">Submit Application</button>
    </form>
  </div>
</div>

<!-- Mobile Footer -->
<footer id="mobile-footer">
  <p>&copy; 2025 Keplaar Esports. All rights reserved.</p>
  <p>Made in Canada üá®üá¶</p>
</footer>

<!-- NOTE: Supabase SDK is now loaded by loader.js before this template -->

<script>
console.log('üì± Mobile-2D template loaded');

// ===== FILE UPLOAD HANDLER FOR MOBILE-2D =====
const mobile2dFileInput = document.getElementById('mobile2d-portfolio');
const mobile2dDropZone = document.getElementById('mobile2d-file-drop');
const mobile2dFilePreview = document.getElementById('mobile2d-file-preview');
const mobile2dFileName = document.getElementById('mobile2d-file-name');
const mobile2dFileSize = document.getElementById('mobile2d-file-size');
const mobile2dFileRemove = document.getElementById('mobile2d-file-remove');

if (mobile2dFileInput && mobile2dDropZone) {
  // Ensure drop zone has relative positioning for overlay
  mobile2dDropZone.style.position = 'relative';
  
  // Handle file selection
  mobile2dFileInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (file && file.type === 'application/pdf') {
      if (file.size > 5 * 1024 * 1024) {
        alert('File size must be less than 5MB');
        mobile2dFileInput.value = '';
        return;
      }
      mobile2dFileName.textContent = file.name;
      mobile2dFileSize.textContent = (file.size / 1024 / 1024).toFixed(2) + ' MB';
      mobile2dDropZone.style.display = 'none';
      mobile2dFilePreview.style.display = 'flex';
      console.log('‚úÖ [Mobile-2D] File selected:', file.name);
    } else {
      alert('Please select a PDF file');
      mobile2dFileInput.value = '';
    }
  });
  
  // Remove file
  if (mobile2dFileRemove) {
    mobile2dFileRemove.addEventListener('click', (e) => {
      e.stopPropagation();
      mobile2dFileInput.value = '';
      mobile2dDropZone.style.display = 'flex';
      mobile2dFilePreview.style.display = 'none';
      console.log('‚ùå [Mobile-2D] File removed');
    });
  }
  
  console.log('‚úÖ [Mobile-2D] File upload handler ready');
}

// ===== FORM SUBMISSION HANDLER FOR MOBILE-2D =====
const mobile2dForm = document.getElementById('mobile-application-form');
const mobile2dFormModal = document.getElementById('mobile-form-modal');

if (mobile2dForm) {
  mobile2dForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const submitBtn = mobile2dForm.querySelector('.submit-button');
    const originalText = submitBtn.textContent;
    
    submitBtn.textContent = 'Submitting...';
    submitBtn.disabled = true;
    
    try {
      // Check if Supabase is ready
      if (!window.supabaseClient) {
        throw new Error('Supabase not initialized. Please refresh the page.');
      }
      
      // Get form data
      const formData = new FormData(mobile2dForm);
      const data = {
        name: formData.get('name'),
        email: formData.get('email'),
        phone: formData.get('phone'),
        game: formData.get('game'),
        rank: formData.get('rank'),
        game_id: formData.get('game_id')
      };
      
      console.log('üìù [Mobile-2D] Submitting application:', data);
      
      // Handle file upload if exists
      let portfolioUrl = null;
      let portfolioName = null;
      let portfolioSize = null;
      
      if (mobile2dFileInput && mobile2dFileInput.files.length > 0) {
        const file = mobile2dFileInput.files[0];
        console.log('üìÑ [Mobile-2D] Uploading file:', file.name);
        
        // Upload to Supabase Storage
        const fileName = `${Date.now()}_${file.name}`;
        const { data: uploadData, error: uploadError } = await window.supabaseClient
          .storage
          .from('portfolios')
          .upload(fileName, file);
        
        if (uploadError) {
          console.error('‚ùå File upload error:', uploadError);
          throw new Error('Failed to upload file: ' + uploadError.message);
        }
        
        console.log('‚úÖ File uploaded:', uploadData);
        
        // Get public URL
        const { data: urlData } = window.supabaseClient
          .storage
          .from('portfolios')
          .getPublicUrl(fileName);
        
        portfolioUrl = urlData.publicUrl;
        portfolioName = file.name;
        portfolioSize = (file.size / 1024 / 1024).toFixed(2) + ' MB';
        
        console.log('üîó File URL:', portfolioUrl);
      }
      
      // Insert into database
      const { data: dbData, error: dbError } = await window.supabaseClient
        .from('applications')
        .insert([{
          ...data,
          portfolio_url: portfolioUrl,
          portfolio_name: portfolioName,
          portfolio_size: portfolioSize
        }])
        .select();
      
      if (dbError) {
        console.error('‚ùå Database error:', dbError);
        throw new Error('Failed to submit application: ' + dbError.message);
      }
      
      console.log('‚úÖ Application saved:', dbData);
      
      // Success!
      alert('‚úÖ Application submitted successfully! We\'ll review it and get back to you soon.');
      mobile2dForm.reset();
      
      // Reset file upload UI
      if (mobile2dFilePreview && mobile2dDropZone) {
        mobile2dFilePreview.style.display = 'none';
        mobile2dDropZone.style.display = 'flex';
      }
      
      mobile2dFormModal.style.display = 'none';
      document.body.style.overflow = 'auto';
      
    } catch (error) {
      console.error('‚ùå [Mobile-2D] Submission error:', error);
      alert('‚ùå Failed to submit: ' + error.message + '\n\nPlease try again or contact us directly.');
    } finally {
      submitBtn.textContent = originalText;
      submitBtn.disabled = false;
    }
  });
}

console.log('‚úÖ Mobile-2D template ready with file upload and form submission');
</script>